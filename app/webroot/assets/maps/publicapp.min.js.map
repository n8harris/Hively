{"version":3,"sources":["app/webroot/js/alloy/alloy.js","app/webroot/js/alloy/alloy.session.js","app/webroot/js/alloy/alloy.api.js","app/webroot/js/alloy/alloy.view.js","app/webroot/js/alloy/alloy.alerts.js","app/webroot/js/alloy/alloy.events.js","app/webroot/js/alloy/alloy.overlay_manager.js","app/webroot/js/alloy/tmpl/alloy.tmpl.alert.js","app/webroot/js/app/app.js","app/webroot/js/app/data.js"],"names":["alloy","global","this","tmpl","views","events","nullFunction","abstractFunction","Error","makeSingleton","ClassName","setInstance","__instance","arguments","getInstance","apply","deleteInstance","inheritFrom","parent","child","Constructor","prototype","superClass_","constructor","isDefined","value","undefined","isNull","isDefindedAndNotNull","buildIndexByField","ary","field","data","i","length","buildIndexFromValue","Session","_sessionId","_loggedIn","_email","_lastLoginDate","_role","_isAdmin","swallowApiCall","EVENT_SESSION_CHANGE","EVENT_LOGIN_FAILURE","EVENT_LOGOUT_FAILURE","response","session_id","role","email","last_login_date","login","password","success","$","window","document","trigger","error","Api","request","api","call","proxy","logout","event","setSessionId","sessionId","getSessionId","isLoggedIn","isAdmin","getEmail","_requests","push","_makeNextCall","opt_event","payload","authHeader","status","message","SESSION_TIMEOUT","shift","prevApi","badRequestStr","splice","statusText","console","log","bootbox","alert","ajax","type","beforeSend","xhr","setRequestHeader","View","Backbone","extend","initialize","options","_","bindAll","_initialize","_isRendered","_isBound","_inDom","inject","element","defaults","method","render","bind","el","onEnterDom","injectChild","addChild","unbind","_render","placeholder","childView","_children","clearChildren","unbindChildren","delegateEvents","bindChildren","_bind","stopListening","undelegateEvents","_unbind","_onEnterDom","onExitDom","_onExitDom","Alerts","_alerts","add","alertView","show","elm","append","is","slideDown","OVERLAY_CLOSED","OverlayManager","opt_data","_overlays","EVENT_CLOSE","_onOverlayClose","view","modalSize","addClass","appendTo","modal","backdrop","keyboard","overlay","isOpen","closeCurrent","removeClass","join","templates","alloy.tmpl.alert","App","environment","models","collections","USER_DELETED","CONTENT_PROGRESS","controls","overlays","vent","Events","Model","Collection","model","Data","session","user","account","users","clubhouseSubscription","completedTasks","progress","chapterActivities","get"],"mappings":"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","file":"publicapp.min.js","sourcesContent":["/**\n *  alloy.js - Part of the Alloy Library\n *\n *  Copyright (c) 2012, Tyler Seymour <tyler@unwitty.com>\n *  All rights reserved.\n *\n *  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the\n *  following conditions are met:\n *\n *  Redistributions of source code must retain the above copyright notice, this list of conditions and the following\n *  disclaimer.\n *\n *  Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following\n *  disclaimer in the documentation and/or other materials provided with the distribution.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n *  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n *  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n *  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n *  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n *  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n */\n\nvar alloy = {};\n\nalloy.global = this;\n\nalloy.tmpl = alloy.tmpl || {};\nalloy.views = alloy.views || {};\nalloy.events = alloy.events || {};\n\n\nalloy.nullFunction = function() {};\n\nalloy.abstractFunction = function() {\n\tthrow new Error(\"Abstract function missing implementation.\");\n};\n\nalloy.makeSingleton = function(ClassName) {\n\tClassName.setInstance = function() {\n\t\treturn ClassName.__instance = new ClassName(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);\n\t};\n\tClassName.getInstance = function() {\n\t\treturn ClassName.__instance || ClassName.setInstance.apply(this, arguments);\n\t};\n\tClassName.deleteInstance = function() {\n\t\tClassName.__instance = null;\n\t};\n};\n\nalloy.inheritFrom = function(parent, child) {\n\tfunction Constructor() {}\n\n\tConstructor.prototype = parent.prototype;\n\tchild.superClass_ = parent.prototype;\n\tchild.prototype = new Constructor();\n\tchild.prototype.constructor = child;\n};\n\nalloy.isDefined = function(value) {\n\treturn value !== undefined;\n};\n\nalloy.isNull = function(value) {\n\treturn value === null;\n};\n\nalloy.isDefindedAndNotNull = function(value) {\n\treturn value != null;\n};\n\n/**\n * Takes an array and builds a dictionary, with each key taken from the specified field in the record\n * @param {!array} ary\n * @param {!string} field\n * @return {object}\n */\n\nalloy.buildIndexByField = function(ary, field) {\n\n\tvar data = {};\n\tfor(var i = 0; i < ary.length; i++) {\n\t\tdata[ary[i][field]] = ary[i];\n\t}\n\treturn data;\n};\n\n/**\n * Take a simple array of values and creates a dictionary, where each value is also the key\n * @param {!array} ary\n */\nalloy.buildIndexFromValue = function(ary) {\n\n\tvar data = {};\n\tfor(var i = 0; i < ary.length; i++) {\n\t\tdata[ary[i]] = ary[i];\n\t}\n\treturn data;\n};","/**\n *  alloy.api.js - Part of the Alloy Library\n *\n *  Copyright (c) 2012, Tyler Seymour <tyler@unwitty.com>\n *  All rights reserved.\n *\n *  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the\n *  following conditions are met:\n *\n *  Redistributions of source code must retain the above copyright notice, this list of conditions and the following\n *  disclaimer.\n *\n *  Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following\n *  disclaimer in the documentation and/or other materials provided with the distribution.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n *  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n *  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n *  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n *  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n *  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n *  @require alloy.js\n *  @require alloy.api.js\n */\n\n/*global $ alloy */\n\n\nalloy.Session = function (data) {\n\n\t/**\n\t * The user's session id\n\t * @property\t{string}\n\t * @protected\n\t */\n\tthis._sessionId = null;\n\n\t/**\n\t * Whether or not user is logged in\n\t * @property\t{bool}\n\t * @protected\n\t */\n\tthis._loggedIn\t= false;\n\n\t/**\n\t * User's email address\n\t * @property\t{string}\n\t * @protected\n\t */\n\tthis._email\t\t= null;\n\n\t/**\n\t * User's last login date\n\t * @property\t{string}\n\t * @protected\n\t */\n\tthis._lastLoginDate\t\t= null;\n\n\t/**\n\t * User's role\n\t * @property\tstring\n\t * @protected\n\t */\n\tthis._role\t= \"anon\";\n\n\t/**\n\t * Whether or not the user has administrative rights\n\t * @property\t{bool}\n\t * @protected\n\t * TODO: Decouple from public library\n\t */\n\tthis._isAdmin\t= false;\n\n\tif(data) {\n\t\tthis.swallowApiCall(data);\n\t}\n};\nalloy.makeSingleton(alloy.Session);\n\n/**\n * Triggered on successful login/logout.\n */\nalloy.Session.EVENT_SESSION_CHANGE\t= 'alloy_event_session_change';\n\n/**\n * Triggered on login failure\n */\nalloy.Session.EVENT_LOGIN_FAILURE\t= 'alloy_event_login_failure';\n\n/**\n * Triggered on logout failure\n */\nalloy.Session.EVENT_LOGOUT_FAILURE\t= 'alloy_event_logout_failure';\n\n/**\n * Processes a response from the backend API, updates session information\n * @param {!object} response\n */\nalloy.Session.prototype.swallowApiCall = function (response) {\n\n\tif (response.session_id && response.role) {\n\n\t\tthis._sessionId = response.session_id;\n\t\tthis._email\t\t= response.email;\n\t\tthis._role\t\t= response.role;\n\t\tthis._lastLoginDate = this._lastLoginDate ? this._lastLoginDate : response.last_login_date;\n\t\tthis._loggedIn\t= false;\n\t\tthis._isAdmin\t= false;\n\n\t\tswitch(this._role) {\n\t\t\tcase 'admin':\n\t\t\t\tthis._isAdmin = true;\n\t\t\t\tthis._loggedIn = true;\n\t\t\t\tbreak;\n\t\t\tcase 'user':\n\t\t\t\tthis._loggedIn = true;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n};\n\n/**\n * Attempt to log log the user in.\n *\n * @param {!string} email\n * @param {!string} password\n */\nalloy.Session.prototype.login = function (email, password) {\n\n\tvar success = function (response) {\n\t\tthis._loggedIn = true;\n\t\t$(window.document).trigger(alloy.Session.EVENT_SESSION_CHANGE, true);\n\t};\n\tvar error = function (response) {\n\t\t$(window.document).trigger(alloy.Session.EVENT_LOGIN_FAILURE);\n\t};\n\n\talloy.Api.getInstance().request({\n\t\tapi\t\t\t: \"user\",\n\t\tcall\t\t: \"login\",\n\t\tdata\t\t: {\n\t\t\temail\t\t: email,\n\t\t\tpassword\t: password\n\t\t},\n\t\tsuccess\t\t: $.proxy(success,\tthis),\n\t\terror\t\t: $.proxy(error,\tthis)\n\t});\n};\n\n/**\n * Attempt to log the user out\n */\nalloy.Session.prototype.logout = function () {\n\n\tvar success = function (event) {\n\t\tthis._loggedIn\t= false;\n\t\tthis._role\t\t= 'anon';\n\t\t$(window.document).trigger(alloy.Session.EVENT_SESSION_CHANGE, false);\n\t};\n\tvar error = function (event) {\n\t\t$(window.document).trigger(alloy.Session.EVENT_LOGOUT_FAILURE);\n\t};\n\n\talloy.Api.getInstance().request({\n\t\tapi\t\t: 'user',\n\t\tcall\t: 'logout',\n\t\tdata\t: {},\n\t\tsuccess : $.proxy(success, this),\n\t\terror\t: $.proxy(error, this)\n\t});\n};\n\nalloy.Session.prototype.setSessionId = function (sessionId) {\n\tthis._sessionId = sessionId;\n};\n\nalloy.Session.prototype.getSessionId = function () {\n\treturn this._sessionId;\n};\n\nalloy.Session.prototype.isLoggedIn = function () {\n\treturn this._loggedIn;\n};\n\nalloy.Session.prototype.getSessionId = function () {\n\treturn this._sessionId;\n};\n\nalloy.Session.prototype.isAdmin = function () {\n\treturn this._isAdmin;\n};\n\nalloy.Session.prototype.getEmail = function () {\n\treturn this._email;\n};\n","/**\n *  alloy.api.js - Part of the Alloy Library\n *\n *  Copyright (c) 2012, Tyler Seymour <tyler@unwitty.com>\n *  All rights reserved.\n *\n *  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the\n *  following conditions are met:\n *\n *  Redistributions of source code must retain the above copyright notice, this list of conditions and the following\n *  disclaimer.\n *\n *  Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following\n *  disclaimer in the documentation and/or other materials provided with the distribution.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n *  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n *  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n *  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n *  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n *  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n *  @require alloy.js\n *  @require alloy.session.js\n */\n\n/*global alloy */\n\n/**\n * The Alloy API library\n *\n * The API forces synchronization of requests to the backend API library.  This is useful as the client state may change\n * as each request as made.\n */\nalloy.Api = function() {\n\n\t/**\n\t * Serialized list of requests\n\t * @protected\n\t */\n\tthis._requests = [];\n};\nalloy.makeSingleton(alloy.Api);\n\n/**\n * Push a new request onto the request queue.\n * @param {!object} data - should contain the following keys\n *\t\t\t\t\t\tdata.api\t{!string}\tThe API library to reference\n *\t\t\t\t\t\tdata.call\t{!string}\tThe API call to make\n *\t\t\t\t\t\tdata.data\t{object}\tAny data to pass to the API call\n *\t\t\t\t\t\tdata.success {function} Called upon success (valid response code returned from API.\n *\t\t\t\t\t\tdata.error\t {function} Called upon error (invalid response code returned from API.\n */\nalloy.Api.prototype.request = function(data) {\n\n\tthis._requests.push(data);\n\n\n\tif(this._requests.length === 1) {\n\t\tthis._makeNextCall();\n\t}\n};\n\n/**\n * Make the next API request\n * @param opt_event\n */\nalloy.Api.prototype._makeNextCall = function(opt_event) {\n\n\tif(this._requests.length === 0) {\n\t\treturn;\n\t}\n\n\t// grab the first request in the queue.  Note that this is not removed until the API call returns\n\tvar request\t= this._requests[0];\n\n\tvar payload = request.data || {};\n//\tpayload.data = request.data; //JSON.stringify(request.data);\n\tpayload.api\t\t= request.api;\n\tpayload.call\t= request.call;\n\n\t// Setting session id to be added as authentication header instead of post param.\n\tvar authHeader = alloy.Session.getInstance().getSessionId();\n\n\n\tvar success = function(response) {\n\t\t// each API returns a session ID. Update our local copy as it may have changed\n\t\talloy.Session.getInstance().swallowApiCall(response);\n\n\t\tif(response.status == -1 && response.message == 'Not authorized') {\n\t\t\t$(window).trigger(alloy.events.SESSION_TIMEOUT);\n\t\t\treturn;\n\t\t}\n\n\t\tif(response.status == -1){\n\t\t\trequest.error(response);\n\t\t\treturn;\n\t\t}\n\t\t// function making the API request may pass along optional success and error callbacks\n\t\t// note that the error one is executed in response to an error code from the API, not the\n\t\t// ajax call failing\n\t\tif(response.status && request.success) {\n\t\t\trequest.success(response);\n\t\t}\n\t\tif(!response.status && request.error) {\n\t\t\trequest.error(response);\n\t\t}\n\n\t\t// remove the front of the call queue and if needed, make the next call\n\t\tthis._requests.shift();\n\t\tif(this._requests.length > 0) {\n\t\t\tthis._makeNextCall();\n\t\t}\n\t};\n\n\tvar error = function(event) {\n\n\t\tif(event.status != 200){\n\n\t\t\tvar prevApi = this._requests[0].api;\n\t\t\tvar prevCall = this._requests[0].call;\n\t\t\tif(prevApi != \"logger\"){\n\t\t\t\tvar badRequestStr = \" for request api:\"+this._requests[0].api+\" call: \"+this._requests[0].call;\n\t\t\t\tthis._requests.splice(0,1);\n\n\t\t\t\talloy.Api.getInstance().request({\n\t\t\t\t\tapi: 'logger',\n\t\t\t\t\tcall: 'add',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmessage: \"\\\"\"+event.status+\" \"+event.statusText+\"\\\"\"+badRequestStr\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: function(response){console.log(response);},\n\t\t\t\t\terror: function(response){console.log(response);}\n\t\t\t\t});\n\n\t\t\t\tif(event.status != 0){\n\t\t\t\t\tbootbox.alert('An error occurred while making a request: '+event.status+' - '+event.statusText);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._requests.shift();\n\t\t\tif(this._requests.length > 0) {\n\t\t\t\tthis._makeNextCall();\n\t\t\t}\n\t\t}\n\n\t};\n\n\t$.ajax(\"/api\", {\n\t\tdata\t: payload,\n\t\tsuccess\t: $.proxy(success, this),\n\t\terror\t: $.proxy(error, this),\n\t\ttype    : 'POST',\n\t\tbeforeSend : function(xhr) {\n\t\t\txhr.setRequestHeader(\"Authorization\", authHeader);\n\t\t}\n\n\t});\n};\n","/**\n *  alloy.view.js - Part of the Alloy Library\n *\n *  Copyright (c) 2012, Tyler Seymour <tyler@unwitty.com>\n *  All rights reserved.\n *\n *  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the\n *  following conditions are met:\n *\n *  Redistributions of source code must retain the above copyright notice, this list of conditions and the following\n *  disclaimer.\n *\n *  Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following\n *  disclaimer in the documentation and/or other materials provided with the distribution.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n *  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n *  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n *  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n *  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n *  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n */\nalloy.View = Backbone.View.extend({\n\n\tinitialize: function(options) {\n\n\t\t_.bindAll(this);\n\t\tthis._initialize(options);\n\n\t\tthis._isRendered = false\n\t\tthis._isBound = false;\n\t\tthis._inDom = false;\n\t},\n\t_initialize: function(options) {},\n\n\tinject: function(element, options) {\n\n\t\toptions = options ? options : {};\n\t\toptions = _.defaults(options, {\n\t\t\tmethod: 'html'\n\t\t});\n\n\t\tif(!this._isRendered) {\n\t\t\tthis.render();\n\t\t}\n\n\t\tif(!this._isBound) {\n\t\t\tthis.bind();\n\t\t}\n\n\n\t\t$(element)[options.method](this.el);\n\n//\t\tif(opt_replace) {\n//\t\t\t$(element).replaceWith(this.el);\n//\t\t} else {\n//\t\t\t$(element).html(this.el);\n//\t\t}\n\n\t\tif(!this._inDom) {\n\t\t\tthis.onEnterDom();\n\t\t}\n\t\treturn this;\n\t},\n\tinjectChild: function(child, element, options) {\n\n\t\tchild.inject(element, options);\n\n\t\tthis.addChild(child);\n\t\treturn this;\n\t},\n\n\trender: function() {\n\t\tif(this._isRendered) {\n\t\t\tthis.unbind();\n\t\t}\n\t\tthis._render();\n\t\tthis.bind();\n\t\tthis._isRendered = true;\n\t\t$('input, textarea', this.el).placeholder();\n\t\treturn this;\n\t},\n\t_render: function() {},\n\taddChild: function(childView) {\n\t\tif(this._children == undefined) {\n\t\t\tthis._children = [];\n\t\t}\n\t\tthis._children.push(childView);\n\t\treturn this;\n\t},\n\tclearChildren: function() {\n\n\t\tthis.unbindChildren();\n\t\tthis._children = [];\n\t\treturn this;\n\t},\n\tbind: function() {\n\n\t\tif(this._isBound) {\n\t\t\treturn this;\n\t\t}\n\n\t\tif(this._isRendered) {\n\t\t\t// Backbone's view will delegate events upon initialization\n\t\t\t// we only need to delegate events if we're re-rendering\n\t\t\tthis.delegateEvents();\n\t\t}\n\n\t\tthis.bindChildren();\n\t\tthis._bind();\n\n\t\tthis._isBound = true;\n\t\treturn this;\n\t},\n\t_bind: function() {},\n\tunbind: function() {\n\t\tthis.stopListening();\n\t\tthis.undelegateEvents();\n\t\tthis.unbindChildren();\n\t\tthis._unbind();\n\t\tthis._isBound = false;\n\t\treturn this;\n\t},\n\t_unbind: function() {},\n\tbindChildren: function() {\n\t\tif(this._children) {\n\t\t\tfor(var i = 0; i < this._children.length; i++) {\n\t\t\t\tthis._children[i].bind();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\tunbindChildren: function() {\n\t\tif(this._children) {\n\t\t\tfor(var i = 0; i < this._children.length; i++) {\n\t\t\t\tthis._children[i].unbind();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\tonEnterDom: function() {\n\n\t\tthis._inDom = true;\n\t\tthis._onEnterDom();\n\t\tif(this._children) {\n\t\t\tfor(var i = 0; i < this._children.length; i++) {\n\t\t\t\tthis._children[i].onEnterDom();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\t_onEnterDom: function() {},\n\tonExitDom: function() {\n\n\t\tthis._inDom = false;\n\t\tthis._onExitDom();\n\t\tif(this._children) {\n\t\t\tfor(var i = 0; i < this._children.length; i++) {\n\t\t\t\tthis._children[i].onExitDom();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\t_onExitDom: function() {}\n\n\n\n});","/**\n *  alloy.alerts.js - Part of the Alloy Library\n *\n *  Copyright (c) 2012, Tyler Seymour <tyler@unwitty.com>\n *  All rights reserved.\n *\n *  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the\n *  following conditions are met:\n *\n *  Redistributions of source code must retain the above copyright notice, this list of conditions and the following\n *  disclaimer.\n *\n *  Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following\n *  disclaimer in the documentation and/or other materials provided with the distribution.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n *  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n *  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n *  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n *  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n *  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n *  @require alloy.js\n */\n/*global alloy*/\n\n\nalloy.Alerts = function() {\n\n\tthis._alerts = [];\n};\nalloy.makeSingleton(alloy.Alerts);\n\nalloy.Alerts.prototype.add = function(alertView) {\n\n\tthis._alerts.push(alertView);\n\treturn this;\n};\n\nalloy.Alerts.prototype.show = function(elm) {\n\n\tfor(var i = 0; i < this._alerts.length; i++) {\n\t\tthis._alerts[i].render();\n\t\t$(elm).append(this._alerts[i].el);\n\t\tif($(elm).is(\":hidden\")) {\n\t\t\t$(elm).slideDown();\n\t\t}\n\t}\n\tthis._alerts = [];\n\treturn this;\n};\n","\nalloy.events.OVERLAY_CLOSED = 'overlay_closed';\nalloy.events.SESSION_TIMEOUT = 'session_timeout';","/**\n *  alloy.overlay_manager.js - Part of the Alloy Library\n *\n *  Copyright (c) 2012, Tyler Seymour <tyler@unwitty.com>\n *  All rights reserved.\n *\n *  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the\n *  following conditions are met:\n *\n *  Redistributions of source code must retain the above copyright notice, this list of conditions and the following\n *  disclaimer.\n *\n *  Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following\n *  disclaimer in the documentation and/or other materials provided with the distribution.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\n *  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n *  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n *  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n *  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\n *  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n *  @require alloy.js\n *  @require alloy.session.js\n */\n/*global alloy */\n\nalloy.OverlayManager = alloy.OverlayManager || {};\n\nalloy.OverlayManager = function(opt_data) {\n\n\tthis._overlays = [];\n\n\t$(window.document).bind(alloy.OverlayManager.EVENT_CLOSE, $.proxy(this._onOverlayClose, this));\n//\t$(document).bind('keyup', $.proxy(this.onKeyUp, this));\n};\nalloy.makeSingleton(alloy.OverlayManager);\nalloy.OverlayManager.EVENT_CLOSE\t= \"alloy_event_overlay_close\";\n\n\nalloy.OverlayManager.prototype.add = function(view) {\n\n\tthis._overlays.push(view);\n\tif(this._overlays.length === 1) {\n\t\tthis.show(this._overlays[0]);\n\t}\n};\n\nalloy.OverlayManager.prototype.show = function(view) {\n\n\tvar modalSize = view.modalSize ? view.modalSize : 'large';\n\n\tview.render();\n\t$(view.el).addClass('modal modal-' + view.modalSize);\n//\t$(view.el).on('hidden.Overlay', $.proxy(this._onOverlayClose, this));\n\t$(view.el).appendTo($(\"body\")).modal({\n\t\tshow: true,\n\t\tbackdrop:true,\n\t\tkeyboard: false\n\t});\n\tview.onEnterDom();\n\t$(\"body\").addClass('modal-open');\n};\n\nalloy.OverlayManager.prototype._onOverlayClose = function(event, overlay) {\n\n\tthis._overlays[0].unbind();\n\t$(this._overlays[0].el).modal('hide');\n//\t$(\"body\").removeClass('modal-open');\n\tthis._overlays.shift();\n\tif(this._overlays.length > 0) {\n\t\tthis.show(this._overlays[0]);\n\t}\n};\n\nalloy.OverlayManager.prototype.isOpen = function() {\n\treturn this._overlays.length > 0;\n}\n\n//alloy.OverlayManager.prototype.getCurrentOverlay = function() {\n//\treturn this._overlays.length > 0 ? this._overlays[0] : null;\n//};\n\n//alloy.OverlayManager.prototype.closeCurrentAndClearAll = function() {\n//\n//\tif(this._overlays.length > 0) {\n//\t\tvar current = this._overlays.shift();\n//\t\tthis._overlays = [];\n//\t\tcurrent.el.remove();\n//\t}\n//};\n\nalloy.OverlayManager.prototype.closeCurrent = function() {\n\n\tif(this._overlays.length > 0) {\n\t\t$(\"body\").removeClass('modal-open');\n\t\tthis._overlays[0].unbind();\n\t\t$(this._overlays[0].el).modal('hide');\n\t\tthis._overlays.shift();\n\t\tif(this._overlays.length > 0) {\n\t\t\tthis.show(this._overlays[0]);\n\t\t}\n\t\t$(window.document).trigger(alloy.events.OVERLAY_CLOSED);\n\t}\n};\n\n//alloy.OverlayManager.prototype.onKeyUp = function(event) {\n//\tif(event.keyCode == 27 && this._overlays.length > 0) {\n//\t\tthis.closeCurrent();\n//\t}\n//};\n","alloy.tmpl.alert = ([\n\t\"<a class='close' data-dismiss='alert' href='#'>&times;</a>\",\n\t\"{{if title}}<h5>${title}</h5>{{/if}}\",\n\t\"{{if message}}<span>${message}</span>{{/if}}\",\n\t\"{{if html}}<div id='html'></div>{{/if}}\"\n]).join(\"\");\n\n$.templates({\n\t\"alloy.tmpl.alert\": alloy.tmpl.alert\n});\n","\nApp = {\n\tenvironment: null,\n\tmodels: {},\n\tcollections: {},\n\ttmpl: {},\n\tevents: {\n\t\tUSER_DELETED: 'user_deleted',\n\t\tCONTENT_PROGRESS: 'content_progress'\n\t},\n\tviews: {},\n\tcontrols: {},\n\toverlays: {},\n\tvent: _.extend({}, Backbone.Events)\n\n};\n\nApp.Model = Backbone.Model.extend({});\n\nApp.Collection = Backbone.Collection.extend({\n\tmodel: App.Model\n});","\nApp.Data = function(data) {\n\n\t_.bindAll(this);\n\n\tdata = data || {};\n\n\n\tdata = _.defaults(data, {\n\t\tsession: new App.Model(),\n\t\tuser: new App.Model(),\n\t\taccount: new App.Model(),\n\t\tusers: new App.Collection(),\n\t\tclubhouseSubscription: new App.Model(),\n\t\tcompletedTasks: new App.Collection(),\n\t\tprogress: new App.Collection(),\n\t\tchapterActivities: new App.Collection()\n\t});\n\n\n\t_.extend(this, data);\n\t\n\t// make sure the root user and the one included in the full user list are the same model\n\tif(this.user.get('id')) {\n\t\tvar user = this.users.get(this.user.get('id'));\n\t\tif(user) {\n\t\t\tthis.user = user;\n\t\t}\n\t}\n};\nalloy.makeSingleton(App.Data);\n\nApp.Data.prototype.isLoggedIn = function() {\n\n\treturn !(this.user.get('role') == 'anon' || this.user.get('role') == undefined);\n};\n\n\n"],"sourceRoot":"/source/"}